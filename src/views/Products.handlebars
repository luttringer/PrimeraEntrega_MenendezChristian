<h1>Products List</h1>
<h2 id="bienvenida"></h2>
<a href="/api/sessions/logout"><button>logout</button></a>
<br>

{{#if category}}
    <p>Category: {{category}}</p>
{{/if}}

{{#if status}}
    <p>Status: {{status}}</p>
{{/if}}

{{#each filterProducts}}
    <p>{{this.title}}</p>
    <p>{{this.price}}</p>
    {{#with this.thumbnail}}
        <img src="{{this.[0]}}">
    {{/with}}
    <br>
    <button>Agregar al Carrito</button> 
{{/each}}

{{#if hasPrevPage}}
    <a href="/products?page={{prevPage}}">Anterior</a>
{{/if}}

<h5>{{page}}</h5>

{{#if hasNextPage}}
    <a href="/products?page={{nextPage}}">Siguiente</a>
{{/if}}



<script>
    const token = localStorage.getItem('accessToken');
    if(!token) window.location.replace('/login');

    fetch('/api/sessions/profileInfo', 
    {
        method:'GET',
        headers:
        {
            authorization: `Bearer ${token}`
        }
    }).then(response=>response.json())
    .then(result=>
    {
        const user =result.payload;
        document.querySelector("#bienvenida").innerHTML = `bienvenido ${user.name}`;
    })
</script>
